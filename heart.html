<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Animasi Menggambar Hati â€” Canvas</title>
<style>
  html,body{height:100%;margin:0;background:#071428;display:flex;align-items:center;justify-content:center;}
  canvas{box-shadow:0 8px 30px rgba(0,0,0,0.5);border-radius:12px;background:linear-gradient(180deg,#072133,#081826);}
  .hint{position:fixed;bottom:14px;color:#bcd9ff88;font-family:sans-serif;font-size:13px}
</style>
</head>
<body>
  <canvas id="c" width="700" height="700"></canvas>
  <div class="hint">Klik canvas untuk restart animasi</div>

<script>
  const canvas = document.getElementById('c');
  const ctx = canvas.getContext('2d');

  const W = canvas.width, H = canvas.height;
  const cx = W/2, cy = H/2 + 30;
  const scale = 14;

  function heartPoint(t){
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
    return {x: x * scale, y: -y * scale};
  }

  function drawGuide(){
    ctx.save();
    ctx.globalAlpha = 0.06;
    ctx.fillStyle = '#ff7b95';
    for(let t=0;t<=Math.PI*2;t+=0.04){
      const p = heartPoint(t);
      ctx.fillRect(cx + p.x -1, cy + p.y -1, 2,2);
    }
    ctx.restore();
  }

  function animateDraw(){
    ctx.clearRect(0,0,W,H);
    drawGuide();

    const steps = 400;
    const pts = [];
    for(let i=0;i<=steps;i++){
      const t = i/steps * Math.PI*2;
      pts.push(heartPoint(t));
    }

    let i = 0;
    ctx.lineWidth = 6;
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
    ctx.strokeStyle = '#ff4d6d';
    ctx.shadowColor = 'rgba(255,80,120,0.25)';
    ctx.shadowBlur = 18;

    function frame(){
      ctx.clearRect(0,0,W,H);
      drawGuide();

      ctx.beginPath();
      for(let k=0;k<=i;k++){
        const p = pts[k];
        const px = cx + p.x, py = cy + p.y;
        if(k===0) ctx.moveTo(px,py);
        else ctx.lineTo(px,py);
      }
      ctx.stroke();

      if(i < pts.length){
        const pp = pts[i];
        ctx.beginPath();
        ctx.fillStyle = '#ffd8df';
        ctx.arc(cx + pp.x, cy + pp.y, 6, 0, Math.PI*2);
        ctx.fill();
      }

      i++;
      if(i <= steps){
        requestAnimationFrame(frame);
      } else {
        fillHeart();
      }
    }
    frame();
  }

  function fillHeart(){
    let alpha = 0;
    const fillStep = ()=>{
      alpha += 0.03;
      ctx.save();
      ctx.globalAlpha = alpha;
      ctx.fillStyle = '#ff7b95';
      ctx.beginPath();
      for(let t=0;t<=Math.PI*2+0.001;t+=0.02){
        const p = heartPoint(t);
        const px = cx + p.x, py = cy + p.y;
        if(t===0) ctx.moveTo(px,py); else ctx.lineTo(px,py);
      }
      ctx.closePath();
      ctx.fill();
      ctx.restore();

      if(alpha < 0.95){
        requestAnimationFrame(fillStep);
      } else {
        showText();
      }
    };
    requestAnimationFrame(fillStep);
  }

  function showText(){
    let textAlpha = 0;
    const text = "I Love You";
    ctx.font = "bold 64px Arial"; // lebih besar
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    function fadeInText(){
      textAlpha += 0.02;

      // bayangan dan outline
      ctx.save();
      ctx.globalAlpha = textAlpha;
      ctx.lineWidth = 6; // ketebalan outline
      ctx.strokeStyle = "#b22222"; // outline merah gelap
      ctx.strokeText(text, cx, cy - 20);

      ctx.fillStyle = "#ffffff"; // teks putih terang
      ctx.shadowColor = "rgba(255,255,255,0.8)";
      ctx.shadowBlur = 15;
      ctx.fillText(text, cx, cy - 20);
      ctx.restore();

      if(textAlpha < 1){
        requestAnimationFrame(fadeInText);
      }
    }
    fadeInText();
  }

  animateDraw();
  canvas.addEventListener('click', ()=> animateDraw());
</script>
</body>
</html>